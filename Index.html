<!DOCTYPE html> 

<html lang="en"> 

<head> 

  <meta charset="UTF-8" /> 

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 

  <title>MU.NEURAL v0.1 - LOCAL INSTANCE</title> 

 

<!-- Piper TTS library ‚Äì put it here, after meta tags, before style --> 

<script type="module" src="https://esm.sh/@pipertalk/piper@0.0.8/dist/piper.min.js"></script> 

  <style> 

    body, html { 

      margin: 0; 

      padding: 0; 

      height: 100%; 

      overflow: hidden; 

      background: #000; 

      font-family: 'Courier New', Courier, monospace; 

      color: #0f0; 

    } 

 

    canvas#matrix { 

      position: fixed; 

      top: 0; left: 0; 

      z-index: 1; 

      opacity: 0.35; 

    } 

 

    #hud { 

      position: fixed; 

      top: 10px; 

      left: 10px; 

      z-index: 3; 

      font-size: 13px; 

      line-height: 1.35; 

      pointer-events: none; 

      opacity: 0.75; 

      text-shadow: 0 0 4px #0f0; 

    } 

 

    #chat-container { 

      position: relative; 

      z-index: 2; 

      height: 100vh; 

      display: flex; 

      flex-direction: column; 

      background: rgba(0,0,0,0.4); 

      backdrop-filter: blur(1.5px); 

    } 

 

    #chat { 

      flex: 1; 

      overflow-y: auto; 

      padding: 20px 30px 100px; 

      box-sizing: border-box; 

    } 

 

    

  .message {  

      margin: 12px 0; 

      padding: 10px 16px; 

      border-radius: 4px;  

      max-width: 78%; 

      line-height: 1.4; 

      background: rgba(0, 40, 0, 0.6); 

      border-left: 3px solid #0a0; 

      animation: fadeIn 0.6s; 

    } 

     

    .user { 

      margin-left: auto; 

      text-align: right; 

      background: rgba(0, 80, 0, 0.45); 

      border-left: 3px solid #0f0; 

    } 

       

    #input-area { 

      position: fixed; 

      bottom: 0;    

      left: 0; right: 0; 

      padding: 16px 20px; 

      background: rgba(0,0,0,0.75); 

      border-top: 1px solid #0a0; 

      display: flex; 

      flex-direction: column; 

      gap: 12px; 

      z-index: 4; 

    } 

       

    .top-controls { 

      display: flex;   

      align-items: center; 

      gap: 12px; 

    } 

       

    #session-select { 

      padding: 8px 12px; 

      font-size: 16px; 

      background: #000;   

      color: #0f0; 

      border: 1px solid #0a0; 

      border-radius: 6px; 

      cursor: pointer; 

      flex: 1; 

      max-width: 200px; 

    } 

 

    #user-input { 

      flex: 1; 

      background: #000; 

      color: #0f0; 

      border: 1px solid #0a0; 

      padding: 12px 16px; 

      font-size: 15px; 

      outline: none; 

      border-radius: 4px; 

     outline: none; 

      border-radius: 4px; 

    } 

   

    #user-input:focus { 

      border-color: #0f0; 

      box-shadow: 0 0 8px #0f08; 

    } 

     

    .button-group { 

      display: flex; 

      gap: 12px; 

      flex-wrap: wrap; 

    } 

           

    button { 

      padding: 12px 20px; 

      background: #0a0; 

      color: #000; 

      border: none; 

      border-radius: 4px; 

      font-weight: bold; 

      cursor: pointer; 

      transition: all 0.2s; 

    } 

       

    button:hover { 

      background: #0f0; 

      box-shadow: 0 0 12px rgba(0,255,0,0.6); 

    } 

     

    #mic-btn { 

      padding: 12px 16px; 

      min-width: 50px; 

      font-size: 18px; 

    } 

       

    #mic-btn.listening { 

      background: #ff4444; 

      color: white; 

    }   

       

    #stop-speech { 

      background: #444;   

      color: white; 

    } 

       

    #stop-speech:hover {    

      background: #ff4444; 

    } 

       

    @keyframes fadeIn { 

      from { opacity: 0; transform: translateY(10px); } 

      to   { opacity: 0.9; transform: translateY(0); } 

    } 

  </style> 

</head> 

<body> 

<canvas id="matrix"></canvas> 

   

  <div id="hud"></div>    

       

  <div id="chat-container"> 

    <div id="chat"></div> 

     

    <div id="input-area"> 

      <div class="top-controls"> 

        <label for="session-select" style="color: #0f0; font-weight: bold;">User:</label> 

        <select id="session-select"> 

          <option value="dad">Dad</option> 

          <option value="daughter">Daughter</option> 

        </select> 

      </div> 

       

      <input id="user-input" type="text" placeholder="NEURAL LINK ACTIVE ‚Äî QUERY MU..." autocomplete="off"/> 

       

      <div class="button-group"> 

        <button id="mic-btn" type="button" title="Click to speak">üé§</button> 

        <button onclick="sendMessage()">SEND</button> 

        <button id="stop-speech" type="button" title="Stop Mu speaking">üõë</button> 

      </div> 

    </div> 

  </div> 

       

  <script> 

    // ‚îÄ‚îÄ‚îÄ MATRIX RAIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 

    const canvas = document.getElementById('matrix'); 

    const ctx = canvas.getContext('2d'); 

       

    canvas.height = window.innerHeight; 

    canvas.width = window.innerWidth; 

       

    window.addEventListener('resize', () => { 

      canvas.height = window.innerHeight; 

      canvas.width = window.innerWidth; 

    }); 

       

    const chars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥0123$ 

    const fontSize = 14;  

    const columns = canvas.width / fontSize; 

    const drops = Array(Math.floor(columns)).fill(1); 

       

    function drawMatrix() { 

      ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; 

      ctx.fillRect(0, 0, canvas.width, canvas.height); 

       

      ctx.fillStyle = '#0f0'; 

      ctx.font = fontSize + 'px monospace'; 

       

      for (let i = 0; i < drops.length; i++) { 

        const text = chars[Math.floor(Math.random() * chars.length)]; 

        const x = i * fontSize; 

        const y = drops[i] * fontSize; 

ctx.fillText(text, x, y); 

     

        if (y > canvas.height && Math.random() > 0.975) drops[i] = 0; 

        drops[i]++; 

      } 

    } 

     

    setInterval(drawMatrix, 45); 

       

    // ‚îÄ‚îÄ‚îÄ FAKE HUD STATS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 

    const hud = document.getElementById('hud'); 

    let stats = [ 

      "NEURAL CORE STATUS: ONLINE", 

      "CPU: 47%  [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]  3.88 GHz", 

      "RAM:  11.2/16.0 GB  (69%)", 

      "VRAM: 4.1/8.0 GB", 

      "NET:   248 ms  |  ‚Üì 142 Mbps  ‚Üë 38 Mbps", 

      "PROTO: TLS 1.3 ‚Ä¢ QUIC ‚Ä¢ IPv6 ‚Ä¢ WebSocket", 

      "UPTIME:  47h 19m 02s",    

      "TEMP:   CPU 68¬∞C  GPU 74¬∞C", 

      "THREADS:  2147  ‚Ä¢  ZOMBIES: 0", 

      "MU v0.1 ‚Ä¢ xAI LOCAL INSTANCE" 

    ]; 

     

    let offset = 0; 

    function updateHUD() { 

      if (Math.random() < 0.08) { 

        stats[1] = `CPU: ${Math.floor(Math.random()*30 + 35)}%  [${'‚ñà'.repeat(Math.floor(Math.random()*8+3))}‚ñë‚ñë‚ñë$ 

        stats[2] = `RAM:  ${(Math.random()*6 + 9).toFixed(1)}/${Math.floor(Math.random()*4 + 14)}.0 GB  (${Math.floor$ 

        stats[4] = `NET:   ${Math.floor(Math.random()*180 + 80)} ms  |  ‚Üì ${Math.floor(Math.random()*200 + 80)} Mbps$  

      } 

     

      offset = (offset + 0.4) % (stats.length * 2); 

      let display = ''; 

      for (let i = 0; i < 8; i++) { 

        const idx = Math.floor((i + offset) % stats.length); 

        display += stats[idx] + '\n';   

      } 

      hud.textContent = display; 

    } 

     

    setInterval(updateHUD, 1800); 

    updateHUD(); 

       

    // ‚îÄ‚îÄ‚îÄ CHAT & VOICE LOGIC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 

    const chat = document.getElementById('chat'); 

    const input = document.getElementById('user-input'); 

    const micButton = document.getElementById('mic-btn'); 

       

    function addMessage(sender, text) { 

      const div = document.createElement('div'); 

      div.className = `message ${sender === 'You' ? 'user' : 'bot'}`; 

      div.textContent = text; 

      chat.appendChild(div);    

      chat.scrollTop = chat.scrollHeight; 

  } 

         

function speak(text) { 

  if (!text || !window.speechSynthesis) return; 

         

  const utterance = new SpeechSynthesisUtterance(text); 

  utterance.rate = 0.85;   // slower = more natural 

  utterance.pitch = 1.1;   // slight raise = warmer/less flat 

  utterance.volume = 1.0; 

       

  // Force best voice (run once in console to see options: speechSynthesis.getVoices()) 

  const voices = speechSynthesis.getVoices();   

  const bestVoice = voices.find(v => 

    v.name.includes('Google') ||    

    v.name.includes('Microsoft') || 

    v.name.includes('Premium') ||  

    v.name.includes('Neural') || 

    v.name.includes('Samantha') || 

    v.name.includes('Daniel') || 

    v.name.includes('Karen')     

  ) || voices.find(v => v.lang.startsWith('en')); 

       

  if (bestVoice) { 

    utterance.voice = bestVoice; 

    console.log('Using best voice:', bestVoice.name, bestVoice.lang); 

  } 

     

  speechSynthesis.speak(utterance); 

} 

    async function sendMessage() { 

      const message = input.value.trim(); 

      if (!message) return; 

     

      addMessage('You', message); 

      input.value = ''; 

       

      const sessionId = document.getElementById('session-select').value; 

         

      try { 

        const res = await fetch('/chat', { 

          method: 'POST', 

          headers: { 'Content-Type': 'application/json' }, 

          body: JSON.stringify({ message, sessionId }) 

        }); 

       

        const data = await res.json(); 

        const reply = data.reply || data.error || '[NO RESPONSE]'; 

     

        addMessage('Mu', reply); 

        speak(reply); 

     

      } catch (err) { 

        addMessage('Mu', `[LINK DOWN] ${err.message}`); 

      } 

    } 

input.addEventListener('keypress', e => { 

      if (e.key === 'Enter') { 

        e.preventDefault(); 

        sendMessage(); 

      }  

    }); 

   

    // ‚îÄ‚îÄ‚îÄ MICROPHONE SUPPORT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; 

    let recognition = null; 

   

    function initMic() { 

      const micButton = document.getElementById('mic-btn'); 

      if (!micButton) { 

        console.warn('Mic button not found'); 

        return; 

      } 

     

      if (SpeechRecognition) {   

        recognition = new SpeechRecognition(); 

        recognition.continuous = false; 

        recognition.interimResults = true; 

        recognition.lang = 'en-US'; 

     

        recognition.onstart = () => { 

          micButton.textContent = 'üî¥'; 

          micButton.classList.add('listening'); 

          input.placeholder = 'Listening... Speak now'; 

        }; 

     

        recognition.onresult = (event) => { 

          let transcript = ''; 

          for (let i = event.resultIndex; i < event.results.length; i++) { 

            transcript += event.results[i][0].transcript; 

          } 

          input.value = transcript.trim(); 

        }; 

         

        recognition.onend = () => { 

          micButton.textContent = 'üé§'; 

          micButton.classList.remove('listening'); 

          input.placeholder = 'NEURAL LINK ACTIVE ‚Äî QUERY MU...'; 

           

          if (input.value.trim().length > 3) { 

            sendMessage(); 

          } 

        }; 

     

        recognition.onerror = (event) => { 

          console.error('Speech recognition error:', event.error); 

          micButton.textContent = 'üé§'; 

          micButton.classList.remove('listening'); 

          input.placeholder = 'NEURAL LINK ACTIVE ‚Äî QUERY MU...'; 

        

          if (event.error === 'aborted' || event.error === 'not-allowed' || event.error === 'permission-denied') { 

            console.log('Session aborted ‚Äî re-initializing. Click mic again.'); 

 

initMic();  // Re-init to force new permission prompt 

          } else if (event.error !== 'no-speech') { 

            alert('Microphone error: ' + event.error); 

          } 

        }; 

        

        // Attach listener 

        micButton.onclick = () => { 

          if (recognition.running) { 

            recognition.stop(); 

            recognition.running = false; 

          } else { 

            try { 

              recognition.start(); 

              recognition.running = true; 

            } catch (err) { 

              alert('Could not start microphone. Check permissions.'); 

            } 

          } 

        }; 

         

      } else { 

        micButton.style.display = 'none'; 

        console.warn('Speech Recognition not supported'); 

      } 

    } 

           

    // Initialize mic 

    initMic(); 

     

    // Re-init on DOM changes (safety net)  

    const inputObserver = new MutationObserver(() => initMic()); 

    inputObserver.observe(document.getElementById('input-area'), { childList: true, subtree: true }); 

             

    // Stop speech button 

    const stopButton = document.getElementById('stop-speech'); 

    if (stopButton) { 

      stopButton.addEventListener('click', () => { 

        console.log('Stop button clicked ‚Äî checking speech state'); 

        console.log('speaking:', speechSynthesis.speaking); 

        console.log('pending:', speechSynthesis.pending); 

        if (speechSynthesis.speaking || speechSynthesis.pending) { 

          speechSynthesis.cancel(); 

          speechSynthesis.cancel(); // double call to force 

          console.log('cancel() called'); 

          stopButton.style.background = '#ff4444'; 

          setTimeout(() => stopButton.style.background = '#444', 300); 

        } else { 

          console.log('No speech active to stop'); 

        } 

      }); 

    } else { 

      console.warn('Stop button not found in DOM'); 

    }   

           

    input.focus(); 

</script> 

           

</body> 

</html> 

 
